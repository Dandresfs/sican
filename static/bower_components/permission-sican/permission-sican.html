<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../iron-ajax/iron-ajax.html">
<link rel="import" href="../paper-item/paper-icon-item.html">
<link rel="import" href="../paper-item/paper-item-body.html">
<link rel="import" href="../image-mask/image-mask.html">
<link rel="import" href="../iron-icons/av-icons.html">
<link rel="import" href="../iron-icon/iron-icon.html">
<link rel="import" href="../iron-collapse/iron-collapse.html">

<dom-module id="permission-sican">

  <style type="text/css">
    .paper-item-link {
        color: inherit;
        text-decoration: none;
    }

    .permission:hover {
        background: #F05623;
        color: white;
    }

    paper-icon-item{
        background: #F05623;
        color: white;
    }

    iron-collapse{
        background: #eee;
        padding: 20px;
    }

    .link-collapse:hover{
        background: #76b82a;
        color: white;
    }

    .list-group{
        margin: 0;
    }

    .permission_class{
        margin-bottom: 10px;
    }

  </style>

  <template>
    <iron-ajax auto url="{{ url }}" handle-as="json" last-response="{{ permission }}"></iron-ajax>
    <div role="listbox">
        <template is="dom-repeat" items="[[permission]]">
            <div class="permission_class" id="[[item.id]]" on-tap="expand">
                <a class="paper-item-link" href="#" id="[[item.id]]">
                    <paper-icon-item class="permission" id="[[item.id]]">
                        <paper-item-body id="[[item.id]]">[[item.name]]</paper-item-body>
                        <iron-icon icon="[[item.icon]]" id="[[item.id]]" item-icon></iron-icon>
                        <iron-icon icon="arrow-drop-down" id="[[item.id]]"></iron-icon>
                    </paper-icon-item>
                </a>
                <iron-collapse id="collapse_[[item.id]]">
                    <div class="list-group">
                        <template is="dom-repeat" items="[[item.links]]" as="links">
                            <a href="[[links.link]]" class="list-group-item link-collapse">
                                &xrarr;&nbsp;&nbsp; [[links.name]]
                            </a>
                        </template>
                    </div>
                </iron-collapse>
            </div>
        </template>
    </div>
  </template>

</dom-module>

<script>

  Polymer({

    is: 'permission-sican',

    properties: {

      url: {
        type: String,
        value: ""
      },

    },

    expand: function(e){

        collapse_text = '#collapse_' + e.target.id;

        var collapse = Polymer.dom(e.currentTarget).querySelector(collapse_text);

        collapse.toggle();
    }

  });


</script>